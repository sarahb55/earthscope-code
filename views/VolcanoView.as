package earthscope.views{		import flash.display.Sprite;	import flash.events.Event;	import flash.display.MovieClip;	import flash.media.Sound;	import flash.net.URLRequest;		import earthscope.models.IGameData;	import earthscope.models.VolcanoData;	import earthscope.events.GameEvent;	import earthscope.events.PuffOfSmokeEvent;	import earthscope.events.VolcanoEruptsEvent;	import earthscope.events.RumbleEvent;	import earthscope.events.VolcanoWakesUpEvent;	import earthscope.utils.SoundPlayer;	import earthscope.utils.SWFPlayer;	import earthscope.utils.DisplayGraphicsFiles;	import earthscope.text.GameText;		import fl.transitions.Tween;	import fl.transitions.TweenEvent;	import fl.transitions.easing.*;	import flash.events.TimerEvent;	import flash.utils.Timer;				public class VolcanoView extends Sprite{						private var _volcano:VolcanoData;		private var _puff:MovieClip;		var num:Number = 0;		var _sound:Sound;		var _play:SoundPlayer;		var _swfPlayer:SWFPlayer;		var _swfPlayer2:SWFPlayer;		var _volcanoImage:DisplayGraphicsFiles;		var _sky:DisplayGraphicsFiles;		var fadeTween:Tween;		var fadeTween1:Tween;		var fadeTween2:Tween;		var _fadeBox:Sprite = new Sprite();		var _rumble:Boolean = false;		var _lava:DisplayGraphicsFiles;		var _smoke:DisplayGraphicsFiles;		var _play2:SoundPlayer = new SoundPlayer();		var _explosion:SoundPlayer = new SoundPlayer();		var _timer = new Timer(6000, 1);				//private var _puff:MovieClip;		//private var _volcanoData:VolcanoData;				public function VolcanoView(data:VolcanoData):void{									trace("Making a volcano view");						_volcano = data;						if(_volcano == null){				return;			}						_play = new SoundPlayer();			_play.loadSound(GameText.SOUNDS_FOLDER + GameText.VOLCANO_WAKESUP);															_volcano.addEventListener(PuffOfSmokeEvent.PUFF_OF_SMOKE, puff);			_volcano.addEventListener(PuffOfSmokeEvent.NO_SMOKE, no_puff);			_volcano.addEventListener(RumbleEvent.RUMBLE, rumble);			_volcano.addEventListener(VolcanoEruptsEvent.VOLCANO_ERUPTS, onVolcanoErupts);			_volcano.addEventListener(VolcanoWakesUpEvent.VOLCANO_WAKES_UP, onVolcanoWakesUp);									_play2.loadSound(GameText.SOUNDS_FOLDER  + "explosion2.mp3");									_sky = new DisplayGraphicsFiles();			_sky.loadFile(GameText.PICTURE_DIRECTORY + GameText.SKY);			addChild(_sky);			_sky.x = GameText.BACK_Y;			_sky.y = GameText.BACK_X;						_lava = new DisplayGraphicsFiles();			_lava.loadFile(GameText.PICTURE_DIRECTORY + "lavaWarning.png");			_lava.x = GameText.BACK_Y;			_lava.y = GameText.BACK_X;						_smoke = new DisplayGraphicsFiles();			_smoke.loadFile(GameText.PICTURE_DIRECTORY + "smokeWarning.png");			_smoke.x = GameText.BACK_Y;			_smoke.y = GameText.BACK_X;												_swfPlayer = new SWFPlayer();			_swfPlayer.loadFile(GameText.MOVIES_DIRECTORY + GameText.PUFF_OF_SMOKE);			addChild(_swfPlayer);			_swfPlayer.x = 240;			_swfPlayer.y = 40;						addChild(_fadeBox);						_volcanoImage = new DisplayGraphicsFiles();			_volcanoImage.loadFile(GameText.PICTURE_DIRECTORY + GameText.VOLCANO_FRONT);			addChild(_volcanoImage);			_volcanoImage.x = GameText.BACK_Y;			_volcanoImage.y = GameText.BACK_X;						_swfPlayer2 = new SWFPlayer();			_swfPlayer2.loadFile(GameText.MOVIES_DIRECTORY + GameText.VOLCANO_ERUPTS);														}						public function updateDisplay():void		{							}				private function onVolcanoWakesUp(VolcanoWakesUpEvent){						addChild(_lava);			addChild(_smoke);						fadeTween2 = new Tween(_smoke, "alpha", Strong.easeIn, 0, 1, 10, true);			fadeTween2.addEventListener(TweenEvent.MOTION_FINISH, motionFinishHandler1);						with (_fadeBox.graphics) {                				beginFill(0x000000, 0.8);                drawRect(stage.x + 20, stage.y + 20, stage.width -300, stage.height -250);                endFill();			}            						fadeTween = new Tween(_fadeBox, "alpha", Strong.easeIn, 0, 1, 10, true);			fadeTween.addEventListener(TweenEvent.MOTION_FINISH, motionFinishHandler);						_timer.start();			_timer.addEventListener(TimerEvent.TIMER, playSounds);					}				private function playSounds(e:TimerEvent){			_play2.play();			_play.play();					}				public function puff(e:PuffOfSmokeEvent):void{						trace("Puff Event detected by VolcanoView....");			_swfPlayer.play();		}				public function no_puff(e:PuffOfSmokeEvent):void{			trace("No puff event");			_swfPlayer.stop();		}				public function rumble(RumbleEvent):void{			//play rumble			trace("Rumble event detected. Play rumble...");						if(_rumble == true){				return;			}						_rumble = true;												_play.play();					}				private function motionFinishHandler1(event:TweenEvent):void{						fadeTween1 = new Tween(_smoke, "alpha", Strong.easeOut, 1, 0.5, 2, true);			_rumble = false;		}				private function motionFinishHandler(TweenEvent):void{						fadeTween1 = new Tween(_fadeBox, "alpha", Strong.easeOut, 1,0.3, 25, true);			_rumble = false;			_play.loadSound(GameText.SOUNDS_FOLDER + GameText.VOLCANO_RUMBLE);			fadeTween1.addEventListener(TweenEvent.MOTION_FINISH, motionFinishHandler3);		}				private function motionFinishHandler3(TweenEvent):void{						if(_fadeBox.parent == this){								removeChild(_fadeBox);			}		}				public function showEruption(){								}				public function onVolcanoErupts(VolcanoEruptsEvent):void{						_swfPlayer2.stop();			addChild(_swfPlayer2);			_swfPlayer2.x = -150;			_swfPlayer2.y = 25;			_swfPlayer2.play();						_play2.play();					}				public function stop(){						_play.stop();			_swfPlayer.stop();		}					}				}